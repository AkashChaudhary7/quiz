<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ | ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º, ‡§®‡•ã‡§ü‡•ç‡§∏ & ‡§™‡•ç‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #28a745;
            --alert-color: #dc3545;
            --warning-color: #ffc107;
            --text-color: #343a40;
            --bg-light: #f8f9fa;
        }

        * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: var(--bg-light); color: var(--text-color); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .container { max-width: 950px; width: 95%; margin: 20px auto; background: #fff; padding: 40px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); text-align: center; }
        
        h1 { color: var(--primary-color); margin-bottom: 20px; font-weight: 700; }
        .menu-screen { display: flex; flex-direction: column; gap: 15px; align-items: center; padding: 20px; }
        
        .mode-button, .action-btn, .skip-btn { width: 100%; padding: 15px; font-size: 1.2em; font-weight: 600; border: none; border-radius: 10px; cursor: pointer; transition: 0.3s; margin-bottom: 10px; text-decoration: none; display: inline-block; }
        .main-btn { background-color: var(--secondary-color); color: white; }
        .action-btn { background-color: var(--primary-color); color: white; }
        .skip-btn { background-color: #6c757d; color: white; }
        .notes-btn { background-color: #6f42c1; color: white; }
        .download-btn { background-color: #e83e8c; color: white; margin-top: 10px; }
        .share-btn { background-color: #25d366; color: white; }

        /* Progress Bar */
        .progress-container { width: 100%; background-color: #e9ecef; border-radius: 10px; height: 12px; margin-bottom: 20px; display: none; overflow: hidden; border: 1px solid #ddd; }
        #progress-bar { height: 100%; background-color: var(--secondary-color); width: 0%; transition: width 0.3s ease; }

        .status-header { display: flex; justify-content: space-between; align-items: center; background: #e9ecef; padding: 15px; border-radius: 10px; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        #timer-box { background: var(--alert-color); color: white; padding: 8px 15px; border-radius: 8px; font-weight: bold; min-width: 90px; }

        .option-item { background: var(--bg-light); padding: 18px; border-radius: 8px; border: 2px solid #ced4da; margin-bottom: 12px; cursor: pointer; list-style: none; text-align: left; font-size: 1.1em; transition: 0.2s; }
        .option-item.correct { background-color: #d4edda; border-color: var(--secondary-color); font-weight: bold; }
        .option-item.incorrect { background-color: #f8d7da; border-color: var(--alert-color); font-weight: bold; }
        .option-item.removed-5050 { opacity: 0.2; pointer-events: none; }
        
        #pdf-viewer-container { display: none; width: 100%; margin-top: 20px; position: relative; }
        .pdf-frame { width: 100%; height: 600px; border: 2px solid #ddd; border-radius: 10px; background: #eee; }

        .review-item { text-align: left; padding: 15px; border-radius: 10px; background: #fdfdfd; border-left: 5px solid #ccc; margin-bottom: 10px; }
        .was-correct { border-left-color: var(--secondary-color); }
        .was-incorrect { border-left-color: var(--alert-color); }

        #loading-overlay { position: fixed; inset: 0; background: white; z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .spinner { border: 6px solid #f3f3f3; border-top: 6px solid var(--primary-color); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        
        .chapters-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; width: 100%; margin-top: 20px; }
        .chapter-box { background-color: var(--bg-light); padding: 20px; border-radius: 12px; border-left: 5px solid var(--primary-color); text-align: left; cursor: pointer; }
        
        .footer { margin-top: 30px; padding: 20px; color: #555; font-size: 0.9em; font-weight: 600; text-align: center; border-top: 1px solid #eee; width: 100%; }
        .heart { color: #e31b23; }
    </style>
</head>
<body>

    <div id="loading-overlay"><div class="spinner"></div><p>‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p></div>

    <div class="container">
        <div id="progress-container" class="progress-container"><div id="progress-bar"></div></div>
        <h1>üìö ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤</h1>
        
        <div id="main-menu" class="menu-screen">
            <button onclick="showScreen('class-selection-menu')" class="mode-button main-btn">üìù ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ñ‡•á‡§≤‡•á‡§Ç</button>
            <button onclick="showScreen('notes-menu')" class="mode-button notes-btn">üìñ ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§™‡•ç‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç & ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
        </div>

        <div id="class-selection-menu" class="menu-screen" style="display:none;">
            <p>‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç:</p>
            <button onclick="selectClass('9')" class="mode-button action-btn">‡§ï‡§ï‡•ç‡§∑‡§æ 9</button>
            <button onclick="selectClass('10')" class="mode-button action-btn">‡§ï‡§ï‡•ç‡§∑‡§æ 10</button>
            <button onclick="showScreen('main-menu')" class="skip-btn">‡§µ‡§æ‡§™‡§∏</button>
        </div>

        <div id="notes-menu" class="menu-screen" style="display:none;">
            <h3>‡§µ‡§ø‡§∑‡§Ø ‡§®‡•ã‡§ü‡•ç‡§∏:</h3>
            <button onclick="handleNotes('9')" class="mode-button action-btn">üìÑ ‡§ï‡§ï‡•ç‡§∑‡§æ 9 ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
            <button onclick="handleNotes('10')" class="mode-button action-btn">üìÑ ‡§ï‡§ï‡•ç‡§∑‡§æ 10 ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
            
            <div id="pdf-viewer-container">
                <p id="loading-pdf" style="display:none;">‡§™‡•ç‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
                <iframe id="pdf-frame" class="pdf-frame" src=""></iframe>
                <a id="direct-download-link" href="#" target="_blank" class="mode-button download-btn">‚¨áÔ∏è ‡§´‡§æ‡§á‡§≤ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</a>
            </div>
            
            <button onclick="showScreen('main-menu')" class="skip-btn" style="margin-top:20px;">‡§µ‡§æ‡§™‡§∏</button>
        </div>

        <div id="quiz-screen" style="display:none; text-align:left;">
            <div class="status-header">
                <button onclick="confirmExit()" class="skip-btn" style="width:auto; padding:5px 12px; margin:0;">üè† ‡§π‡•ã‡§Æ</button>
                <span id="quiz-mode-display"></span>
                <span>‡§™‡•ç‡§∞‡§∂‡•ç‡§®: <span id="current-question-display"></span> / <span id="total-questions-display"></span></span>
                <div id="timer-box">‚è∞ 20s</div>
                <button id="lifeline-btn" onclick="use5050Lifeline()" class="action-btn" style="width:auto; padding:5px 12px; margin:0;">50:50 (<span id="lifeline-count">2</span>)</button>
            </div>
            <p id="question-text" style="font-weight:600; font-size:1.4em;"></p>
            <ul id="options-container" style="padding:0; list-style:none;"></ul>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button id="pause-btn" onclick="togglePause()" class="skip-btn" style="flex:1;">‚è∏Ô∏è ‡§∞‡•ã‡§ï‡•á‡§Ç</button>
                <button onclick="restartQuiz()" class="skip-btn" style="background-color:var(--warning-color); color:#333; flex:1;">üîÑ ‡§∞‡§ø‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü</button>
            </div>
        </div>

        <div id="result-screen" style="display:none;">
            <h2>‡§™‡§∞‡§ø‡§£‡§æ‡§Æ üéâ</h2>
            <div id="results" style="font-size:2em; color:var(--secondary-color); font-weight:bold; margin-bottom:20px;"></div>
            <button onclick="shareResult()" class="mode-button share-btn">üì§ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
            <button onclick="toggleAnswerKey()" class="mode-button action-btn" style="background-color: var(--warning-color); color: #333;">üìñ ‡§â‡§§‡•ç‡§§‡§∞ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
            <button onclick="showScreen('main-menu')" class="mode-button skip-btn">‡§π‡•ã‡§Æ</button>
            <div id="answer-key" style="display:none; margin-top:20px;"></div>
        </div>

        <div id="mode-selection-menu" class="menu-screen" style="display:none;">
            <button onclick="showChapterSelection()" class="mode-button action-btn">‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø-‡§µ‡§æ‡§∞ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º</button>
            <button onclick="startRandomQuiz()" class="mode-button action-btn" style="background-color:var(--warning-color); color:#333;">‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï 20 ‡§™‡•ç‡§∞‡§∂‡•ç‡§®</button>
            <button onclick="showScreen('class-selection-menu')" class="skip-btn">‡§µ‡§æ‡§™‡§∏</button>
        </div>

        <div id="chapter-selection-screen" style="display:none;">
            <div id="chapters-grid" class="chapters-grid"></div>
            <button onclick="showScreen('mode-selection-menu')" class="skip-btn" style="margin-top:20px;">‡§µ‡§æ‡§™‡§∏</button>
        </div>

        <div class="footer">
            || Made with <span class="heart">‚ù§Ô∏è</span> by Akash Chaudhary ||
        </div>
    </div>

    <script>
        const MAX_QUESTIONS = 20, TIME_LIMIT = 20;
        let questions_data = {'9':[], '10':[]}, chapters_data = {'9':[], '10':[]};
        let quizQuestions = [], userResponses = [], currentQuestionIndex = 0, score = 0, timeLeft = TIME_LIMIT;
        let timerInterval, lifelines = 2, currentClass = null, isAnswered = false, isPaused = false, lastMode = "";

        const correctAudio = new Audio('audio/correct.mp3'); 
        const incorrectAudio = new Audio('audio/incorrect.mp3');

        async function loadData() {
            try {
                const [d9, d10] = await Promise.all([
                    fetch('data/class9.json').then(res => res.json()),
                    fetch('data/class10.json').then(res => res.json())
                ]);
                questions_data['9'] = d9.questions; questions_data['10'] = d10.questions;
                chapters_data['9'] = d9.chapters; chapters_data['10'] = d10.chapters;
                document.getElementById('loading-overlay').style.display = 'none';
            } catch (e) { alert("Data Sync Error! Check data/ folder."); }
        }

        function showScreen(id) {
            document.querySelectorAll('.container > div:not(.progress-container)').forEach(d => {
                if (d.id !== 'loading-overlay') d.style.display = 'none';
            });
            document.getElementById('progress-container').style.display = (id === 'quiz-screen') ? 'block' : 'none';
            document.getElementById(id).style.display = (id === 'quiz-screen' || id === 'chapter-selection-screen') ? 'block' : 'flex';
            // Ensure footer always shows
            document.querySelector('.footer').style.display = 'block';
        }

        function handleNotes(cls) {
            const rawUrl = `https://raw.githubusercontent.com/AkashChaudhary7/quiz/main/notes/SCIENCE%20CLASS%20${cls}%20-%20ALL%20CHAPTER%20NOTES.pdf`;
            const previewUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(rawUrl)}&embedded=true`;
            document.getElementById('pdf-frame').src = previewUrl;
            document.getElementById('direct-download-link').href = rawUrl;
            document.getElementById('pdf-viewer-container').style.display = 'block';
            document.getElementById('loading-pdf').style.display = 'block';
            document.getElementById('pdf-frame').onload = () => { document.getElementById('loading-pdf').style.display = 'none'; };
        }

        function selectClass(cls) { currentClass = cls; showScreen('mode-selection-menu'); }

        function showChapterSelection() {
            showScreen('chapter-selection-screen');
            const grid = document.getElementById('chapters-grid'); grid.innerHTML = '';
            chapters_data[currentClass].forEach(ch => {
                const b = document.createElement('div'); b.className = 'chapter-box';
                b.innerHTML = `<h3>${ch.name}</h3><p>${ch.sub}</p>`;
                b.onclick = () => {
                    quizQuestions = questions_data[currentClass].filter(q => q.chapter === ch.code).sort(()=>.5-Math.random()).slice(0, MAX_QUESTIONS);
                    initQuiz(ch.name);
                };
                grid.appendChild(b);
            });
        }

        function startRandomQuiz() {
            quizQuestions = questions_data[currentClass].sort(()=>.5-Math.random()).slice(0, MAX_QUESTIONS);
            initQuiz("‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§®");
        }

        function initQuiz(mode) {
            lastMode = mode; currentQuestionIndex = 0; score = 0; lifelines = 2; isPaused = false; userResponses = [];
            document.getElementById('quiz-mode-display').textContent = mode;
            document.getElementById('total-questions-display').textContent = quizQuestions.length;
            showScreen('quiz-screen'); showQuestion();
        }

        function showQuestion() {
            isAnswered = false; const q = quizQuestions[currentQuestionIndex];
            document.getElementById('progress-bar').style.width = `${(currentQuestionIndex / quizQuestions.length) * 100}%`;
            document.getElementById('current-question-display').textContent = currentQuestionIndex + 1;
            document.getElementById('question-text').textContent = q.question;
            document.getElementById('lifeline-count').textContent = lifelines;
            const cont = document.getElementById('options-container'); cont.innerHTML = '';
            [...q.options].sort(()=>.5-Math.random()).forEach(o => {
                const li = document.createElement('li'); li.className = 'option-item'; li.textContent = o;
                li.onclick = () => checkAnswer(li, o, q.answer); cont.appendChild(li);
            });
            resetTimer();
        }

        function checkAnswer(li, sel, cor) {
            if(isAnswered || isPaused) return; isAnswered = true; clearInterval(timerInterval);
            userResponses.push({q: quizQuestions[currentQuestionIndex].question, s: sel || "‡§∏‡§Æ‡§Ø ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§", c: cor, ok: sel === cor});
            if(sel === cor) { li.classList.add('correct'); score++; correctAudio.play().catch(e=>{}); } 
            else { if(li) li.classList.add('incorrect'); incorrectAudio.play().catch(e=>{}); Array.from(document.querySelectorAll('.option-item')).forEach(i => {if(i.textContent===cor) i.classList.add('correct');}); }
            setTimeout(() => { currentQuestionIndex++; if(currentQuestionIndex < quizQuestions.length) showQuestion(); else showResults(); }, 1200);
        }

        function togglePause() {
            isPaused = !isPaused; document.getElementById('pause-btn').textContent = isPaused ? "‚ñ∂Ô∏è ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç" : "‚è∏Ô∏è ‡§∞‡•ã‡§ï‡•á‡§Ç";
            if(isPaused) clearInterval(timerInterval); else resumeTimer();
        }

        function resetTimer() { timeLeft = TIME_LIMIT; resumeTimer(); }
        function resumeTimer() {
            timerInterval = setInterval(() => {
                timeLeft--; document.getElementById('timer-box').textContent = `‚è∞ ${timeLeft}s`;
                if(timeLeft <= 0) { clearInterval(timerInterval); checkAnswer(null, null, quizQuestions[currentQuestionIndex].answer); }
            }, 1000);
        }

        function use5050Lifeline() {
            if(lifelines <= 0 || isAnswered) return;
            const cor = quizQuestions[currentQuestionIndex].answer;
            let rem = 0; Array.from(document.querySelectorAll('.option-item')).forEach(li => {
                if(li.textContent !== cor && rem < 2) { li.classList.add('removed-5050'); rem++; }
            });
            lifelines--; document.getElementById('lifeline-count').textContent = lifelines;
        }

        function showResults() {
            showScreen('result-screen');
            document.getElementById('results').innerHTML = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${score} / ${quizQuestions.length}`;
            const key = document.getElementById('answer-key'); key.innerHTML = '<h3>‡§â‡§§‡•ç‡§§‡§∞ ‡§ï‡•Å‡§Ç‡§ú‡•Ä:</h3>';
            userResponses.forEach(r => {
                key.innerHTML += `<div class="review-item ${r.ok?'was-correct':'was-incorrect'}">
                    <b>Q:</b> ${r.q}<br><b>Ans:</b> ${r.s} ${r.ok?'':'<br><b>Correct:</b> '+r.c}</div>`;
            });
        }

        function shareResult() {
            const text = `‡§Æ‡•à‡§Ç‡§®‡•á ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§Æ‡•á‡§Ç ${score}/${quizQuestions.length} ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§ï‡§ø‡§Ø‡§æ! ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§≠‡•Ä ‡§ö‡•Å‡§®‡•å‡§§‡•Ä ‡§≤‡•á‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç: ${window.location.href}`;
            if(navigator.share) { navigator.share({ title: '‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü', text: text, url: window.location.href }); } 
            else { window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`); }
        }

        function toggleAnswerKey() { const k = document.getElementById('answer-key'); k.style.display = k.style.display==='none'?'block':'none'; if(k.style.display==='block') k.scrollIntoView({behavior:'smooth'}); }
        function restartQuiz() { if(confirm("‡§∞‡§ø‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü?")) initQuiz(lastMode); }
        function confirmExit() { if(confirm("‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§õ‡•ã‡§°‡§º‡§ï‡§∞ ‡§π‡•ã‡§Æ ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç?")) { clearInterval(timerInterval); showScreen('main-menu'); } }

        window.onload = loadData;
    </script>
</body>
</html>
